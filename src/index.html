<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Blacklight</title>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="/dist/output.css" rel="stylesheet" />
  </head>
  <style>
    .background-image {
      background-image: url("images/assets/Background.png");
      background-size: cover;
      background-position: 100% 0%;
    }
    h2 {
      font-family: "changa";
    }
    h3 {
      font-family: "changa";
    }
    h4 {
      font-family: "roboto-bold";
    }
    .h4 {
      font-family: "roboto-bold";
    }
    li {
      font-family: "roboto-regular";
      color: white;
      font-size: 12px;
      margin-top: 10px;
    }
    ul {
      list-style: none;
    }
    li::before {
      content: "â€¢ ";
      color: white; /* or whatever color you prefer */
    }

    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }
    ::-webkit-scrollbar-track {
      background-color: black;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(16, 192, 101, 1);
      border-radius: 10px;
    }
    .infopopup {
      border: double 3px transparent;
      background-image: linear-gradient(black, black),
        linear-gradient(
          90deg,
          rgba(56, 12, 195, 1) 0%,
          rgba(16, 192, 101, 1) 100%
        );
      background-origin: border-box;
      background-clip: padding-box, border-box;
    }
    .button {
      height: 50px;
      width: 200px;
      border-radius: 10px;
      background: linear-gradient(
        90deg,
        rgba(56, 12, 195, 1) 0%,
        rgba(16, 192, 101, 1) 100%
      );
      font-family: "roboto-bold";
    }
    .border-button {
      border-radius: 10px;
      padding: 1rem;
      height: 50px;
      font-family: "roboto-bold";
      font-size: 1rem;
      padding: 0.5rem 3rem;
      color: black;
      box-shadow: 0 0 6px 0 rgba(157, 96, 212, 0.5);
      border: solid 3px transparent;
      background-image: linear-gradient(
          rgba(255, 255, 255, 0),
          rgba(255, 255, 255, 0)
        ),
        linear-gradient(
          90deg,
          rgba(56, 12, 195, 1) 0%,
          rgba(16, 192, 101, 1) 100%
        );
      background-origin: border-box;
      background-clip: content-box, border-box;
      box-shadow: 2px 1000px 1px black inset;
    }
    .customize-button {
      border-radius: 10px;
      border-width: 3px;
      height: 40px;
      width: 40px;
      border-color: rgba(16, 192, 101, 1);
      background-color: black;
      font-family: "roboto-bold";
    }
    .blacklight-button {
      border-radius: 10px;
      border-width: 3px;
      height: 40px;
      width: 40px;
      border-color: white;
    }
    .blacklight-selected {
      border-color: rgba(16, 192, 101, 1);
    }
    .searchbar {
      height: 50px;
      width: 350px;
      background-color: black;
      border-radius: 10px;
      border-width: 3px;
      border-color: rgba(56, 12, 195, 1);
      font-family: "roboto-bold";
    }
    .searchbar:focus {
      outline: none !important;
      border-radius: 10px;
      border-width: 3px;
      border-color: rgba(16, 192, 101, 1);
    }
    .trait {
      background-image: url("");
      background-size: cover;
    }
    .trait-selected {
      border-radius: 10px;
      border-width: 3px;
      border-color: rgba(16, 192, 101, 1);
    }

    .nft-holder-overlay {
      transition: 0.1s ease;
      opacity: 0;
      left: 0%;
      background-color: rgba(0, 0, 0, 0.5);
      transform: translate(0%, -95%);
    }
    .nft-holder-overlay:hover {
      opacity: 1;
    }

    .nft {
      height: 100%;
      width: 100%;
      background-image: url("images/TestNFT.jpg");
      background-size: cover;
    }

    .blend {
      height: 100%;
      width: 100%;
      mix-blend-mode: color;
      background-image: url("images/00_01.png");
      background-size: cover;
      transform: translateY(-100%);
    }

    .blacklight {
      height: 100%;
      width: 100%;
      mix-blend-mode: multiply;
      background-image: url("");
      background-size: cover;
      transform: translateY(-200%);
      position: relative;
    }

    .background {
      height: 100%;
      width: 100%;
      mix-blend-mode: screen;
      background-image: url("");
      background-size: cover;
      transform: translateY(-300%);
      position: relative;
    }

    .body {
      height: 100%;
      width: 100%;
      mix-blend-mode: screen;
      background-image: url("");
      background-size: cover;
      transform: translateY(-400%);
      position: relative;
    }

    .head {
      height: 100%;
      width: 100%;
      mix-blend-mode: screen;
      background-image: url("");
      background-size: cover;
      transform: translateY(-500%);
      position: relative;
    }
    .nft-overlay {
      height: 100%;
      width: 100%;
      mix-blend-mode: normal;
      background-image: url("images/assets/Overlay.png");
      background-size: cover;
      position: absolute;
    }

    @media (min-width: 1280px) {
      .blacklight-button {
        height: 50px;
        width: 50px;
      }
      .customize-button {
        height: 50px;
        width: 50px;
      }
      li {
        font-size: 16px;
      }
    }

    @font-face {
      font-family: changa;
      src: url("images/assets/ChangaOne-Italic.ttf");
    }
    @font-face {
      font-family: roboto-bold;
      src: url("images/assets/Roboto-Bold.ttf");
    }
    @font-face {
      font-family: roboto-regular;
      src: url("images/assets/Roboto-Regular.ttf");
    }
  </style>

  <body class="bg-black">
    <div
      x-data="{
        showpopup: true,
        backgroundShow: false,
        bodyShow: false,
        headShow: false,
        search: '',
        state:0
    }"
    >
      <div class="background-image h-screen w-full">
        <div
          x-show="state > 0"
          class="absolute top-0 flex h-20 w-full items-center justify-between p-5"
        >
          <img src="images/assets/logo.svg" class="w-[100px]" alt="" />
          <button
            class="border-button flex items-center justify-center px-3 text-white"
          >
            <img
              class="mr-3 w-[25px]"
              src="images/assets/WalletIcon.png"
              alt=""
            />
            <h4>2345 ... hjghj</h4>
            <img
              class="ml-3 h-[9px] w-[15px]"
              src="images/assets/DownArrow.png"
              alt=""
            />
          </button>
        </div>
        <div id="connect" x-show="state == 0" x-transition>
          <div class="flex h-screen w-full items-center justify-center">
            <div>
              <img
                src="images/assets/logo.svg"
                class="mx-auto w-[250px] md:w-[300px]"
                alt=""
              />
              <h2
                class="mt-4 text-center text-[25px] text-white md:text-[35px]"
              >
                Blacklight Upgrade
              </h2>
            </div>
          </div>
          <div
            class="absolute bottom-10 flex w-full flex-col items-center justify-center gap-2"
          >
            <h2 x-text="$store.timer " class="text-[20px] text-white">Text</h2>
            <button
              x-on:click="if($store.timeLeft >= 0) {state++}"
              x-text="$store.timeLeft >= 0 ? 'Connect' : 'Expired'"
              x-bind:class="$store.timeLeft >= 0 ? '': 'opacity-25'"
              class="button text-white focus:bg-white"
            >
              Connect
            </button>
          </div>
        </div>
        <div id="choose" x-show="state == 1" x-transition>
          <div
            class="absolute bottom-[70vh] flex h-[100px] w-full items-center justify-center"
          >
            <input
              x-model="search"
              placeholder="Search serial number..."
              class="searchbar m-5 w-full px-2 text-white md:w-[350px]"
            />
          </div>
          <div
            class="absolute bottom-0 h-[70vh] w-full overflow-y-scroll xl:px-52"
          >
            <div
              class="grid grid-cols-1 gap-4 pb-5 md:grid-cols-3 xl:grid-cols-4"
            >
              <template x-for="nft in $store.nfts">
                <div
                  x-show="search == '' || nft.name.includes(search)"
                  class="mx-auto h-[250px] w-[200px] overflow-hidden rounded-[10px] bg-black"
                >
                  <img src="images/TestNFT.jpg" alt="" />
                  <h3 x-text="nft.name" class="mt-3 text-center text-white">
                    Vamp #1293
                  </h3>
                  <div
                    class="nft-holder-overlay flex h-[250px] w-[200px] items-center rounded-[10px] p-3"
                  >
                    <button
                      x-on:click="state++"
                      class="button text-white focus:bg-white"
                    >
                      Upgrade
                    </button>
                  </div>
                </div>
              </template>
            </div>
          </div>
          <div
            id="infopopup"
            x-show="showpopup"
            x-transition
            class="popup absolute flex h-screen w-full items-center justify-center bg-[rgba(0,0,0,0.5)]"
          >
            <div
              class="infopopup flex max-h-[100vh] w-[90vw] flex-col items-center justify-between rounded-[15px] bg-black py-5 px-5 md:h-[600px] md:w-[500px]"
            >
              <h2 class="mb-2 text-center text-[30px] text-white">
                Good to know
              </h2>
              <ul class="text-justify">
                <li>
                  CUSTOMIZE A BLACKLIGHT UPGRADE for your Vampires! Design your
                  NFTs with plenty of brand-new Vampire Invasion traits.
                </li>
                <li>
                  THE ORIGINAL ART REMAINS, and the blacklight design will be
                  visible after double-clicking on the image.
                </li>
                <li>
                  YOUR NFT WILL BE REMINTED, and the file will change from a JPG
                  to an interactive HTML/CSS. This process is irreversible.
                </li>
                <li>
                  SOME TRAITS WILL ONLY BE AVAILABLE FOR A LIMITED TIME.
                  However, NFTs from future Burn collaborations will have these
                  traits available for customization for 72 hours.
                </li>
                <li>
                  UPGRADE AVAILABLE UNTIL 15th of February 2023. The maximum
                  supply is based on the Vampire Invasion supply.;â€™/\]
                </li>
                <li>PRICE: 65 ADA per upgrade.</li>
              </ul>
              <button
                x-on:click="console.log('pressed'); showpopup = false"
                class="button mt-3 text-white focus:bg-white"
              >
                Okay
              </button>
            </div>
          </div>
        </div>
        <div id="customization" x-show="state == 2" x-transition>
          <div
            class="flex w-full grid-cols-1 flex-col items-center justify-center gap-[150px] pt-[150px] align-middle lg:h-screen lg:grid-cols-2 lg:flex-row lg:pt-0 xl:mx-auto xl:w-[90vw]"
          >
            <div
              class="relative h-[70vw] w-[70vw] lg:h-[300px] lg:w-[300px] xl:h-[450px] xl:w-[450px]"
            >
              <div id="image" class="absolute h-[100%] w-[100%]">
                <div class="nft"></div>
                <div class="blend"></div>
                <div class="blacklight"></div>
                <div class="background"></div>
                <div class="body"></div>
                <div class="head"></div>
              </div>
              <div class="nft-overlay"></div>
              <div
                class="absolute bottom-[-70px] flex h-[50px] w-[100%] justify-center gap-[10px]"
              >
                <div
                  x-on:click="$store.blacklight = 1; changeImage('blacklight')"
                  x-bind:class="$store.blacklight == 1 ? 'blacklight-selected' : '' "
                  class="blacklight-button bg-pink-600 hover:cursor-pointer"
                ></div>
                <div
                  x-on:click="$store.blacklight = 2; changeImage('blacklight')"
                  x-bind:class="$store.blacklight == 2 ? 'blacklight-selected' : '' "
                  class="blacklight-button bg-purple-800 hover:cursor-pointer"
                ></div>
                <div
                  x-on:click="$store.blacklight = 3; changeImage('blacklight')"
                  x-bind:class="$store.blacklight == 3 ? 'blacklight-selected' : '' "
                  class="blacklight-button bg-blue-800 hover:cursor-pointer"
                ></div>
              </div>
              <!-- Head -->
              <button
                class="customize-button absolute left-[-13vw] top-[14vw] flex items-center justify-center md:top-[100px] md:left-[-70px] lg:top-[65px] xl:top-[100px] xl:left-[-70px]"
                x-on:click="$store.head--; changeImage('head')"
              >
                <img class="w-[10px]" src="images/assets/Arrow.png" alt="" />
              </button>
              <button
                class="customize-button absolute right-[-13vw] top-[14vw] flex items-center justify-center md:top-[100px] md:right-[-70px] lg:top-[65px] xl:top-[100px] xl:right-[-70px]"
                x-on:click="$store.head++; changeImage('head')"
              >
                <img
                  class="w-[10px] scale-x-[-1]"
                  src="images/assets/Arrow.png"
                  alt=""
                />
              </button>
              <!-- Background -->
              <button
                class="customize-button absolute left-[-13vw] top-[50%] mt-[-20px] flex items-center justify-center md:left-[-70px] xl:mt-[-25px]"
                x-on:click="$store.background--; changeImage('background')"
              >
                <img class="w-[10px]" src="images/assets/Arrow.png" alt="" />
              </button>
              <button
                class="customize-button absolute right-[-13vw] top-[50%] mt-[-20px] flex items-center justify-center md:right-[-70px] xl:mt-[-25px]"
                x-on:click="$store.background++; changeImage('background')"
              >
                <img
                  class="w-[10px] scale-x-[-1]"
                  src="images/assets/Arrow.png"
                  alt=""
                />
              </button>
              <!-- Body -->
              <button
                class="customize-button absolute left-[-13vw] bottom-[14vw] flex items-center justify-center md:left-[-70px] md:bottom-[100px] lg:bottom-[65px] xl:left-[-70px] xl:bottom-[100px]"
                x-on:click="$store.body--; changeImage('body')"
              >
                <img class="w-[10px]" src="images/assets/Arrow.png" alt="" />
              </button>
              <button
                class="customize-button absolute right-[-13vw] bottom-[14vw] flex items-center justify-center md:right-[-70px] md:bottom-[100px] lg:bottom-[65px] xl:right-[-70px] xl:bottom-[100px]"
                x-on:click="$store.body++; changeImage('body')"
              >
                <img
                  class="w-[10px] scale-x-[-1]"
                  src="images/assets/Arrow.png"
                  alt=""
                />
              </button>
            </div>

            <div
              class="flex h-[450px] w-full flex-col items-start justify-around rounded-[10px] bg-black px-4 lg:h-[400px] lg:w-[400px] xl:w-[500px]"
            >
              <h2 class="text-left text-[20px] text-white xl:text-[30px]">
                CUSTOMIZE YOUR VAMPIRE
              </h2>
              <!-- Head -->
              <div>
                <div
                  x-on:click="headShow = !headShow; backgroundShow = false; bodyShow = false;"
                  class="flex select-none items-center hover:cursor-pointer"
                >
                  <img
                    x-bind:class="headShow ? '' : 'rotate-180'"
                    class="mr-3 h-[10px] w-[15px]"
                    src="images/assets/GreenArrow.png"
                    alt=""
                  />
                  <h4 class="text-[20px] text-white">Head</h4>
                </div>
                <div
                  class="flex items-center overflow-x-scroll"
                  x-show="headShow"
                  x-transition
                >
                  <template x-for="(trait, index) in $store.headTraits">
                    <div
                      x-on:click="$store.head = index + 1; changeImage('head')"
                      x-bind:class="$store.head == index + 1 ? 'trait-selected' : ''"
                      x-bind:style="`background-image: url(collab-logos/${trait.collab}.png`"
                      class="trait m-2 h-[80px] w-[80px]"
                      alt=""
                    ></div>
                  </template>
                </div>
              </div>
              <!-- Body -->
              <div>
                <div
                  x-on:click="bodyShow= !bodyShow; backgroundShow = false; headShow = false;"
                  class="flex select-none items-center hover:cursor-pointer"
                >
                  <img
                    x-bind:class="bodyShow ? '' : 'rotate-180'"
                    class="mr-3 h-[10px] w-[15px]"
                    src="images/assets/GreenArrow.png"
                    alt=""
                  />
                  <h4 class="text-[20px] text-white">Body</h4>
                </div>
                <div
                  class="flex items-center overflow-x-scroll"
                  x-show="bodyShow"
                  x-transition
                >
                  <template x-for="(trait, index) in $store.bodyTraits">
                    <div
                      x-on:click="$store.body = index + 1; changeImage('body')"
                      x-bind:class="$store.body == index + 1 ? 'trait-selected' : ''"
                      x-bind:style="`background-image: url(collab-logos/${trait.collab}.png`"
                      class="trait m-2 h-[80px] w-[80px]"
                      alt=""
                    ></div>
                  </template>
                </div>
              </div>
              <!-- Background -->
              <div>
                <div
                  x-on:click="backgroundShow = !backgroundShow; bodyShow = false; headShow = false"
                  class="flex select-none items-center hover:cursor-pointer"
                >
                  <img
                    x-bind:class="backgroundShow ? '' : 'rotate-180'"
                    class="mr-3 h-[10px] w-[15px]"
                    src="images/assets/GreenArrow.png"
                    alt=""
                  />
                  <h4 class="text-[20px] text-white">Background</h4>
                </div>
                <div
                  class="flex items-center overflow-x-scroll"
                  x-show="backgroundShow"
                  x-transition
                >
                  <template x-for="(trait, index) in $store.backgroundTraits">
                    <div
                      x-on:click="$store.background = index + 1; changeImage('background')"
                      x-bind:class="$store.background == index + 1 ? 'trait-selected' : ''"
                      x-bind:style="`background-image: url(collab-logos/${trait.collab}.png`"
                      class="trait m-2 h-[80px] w-[80px]"
                      alt=""
                    ></div>
                  </template>
                </div>
              </div>
              <div class="flex w-[100%] items-center justify-around">
                <h4
                  x-on:click="state = 1"
                  class="text-white no-underline underline-offset-4 hover:cursor-pointer hover:underline"
                >
                  Cancel
                </h4>
                <button
                  onclick="download()"
                  class="button text-white focus:bg-white"
                >
                  Purchase
                </button>
              </div>
            </div>
          </div>

          <!-- <template x-for="(trait, index) in $store.traits">
        <button
          class="mx-1 justify-start rounded-lg bg-black px-2 text-white"
          x-on:click="$store.count = index + 1; changeImage()"
          x-text="trait.name + ' ' + (index +1)"
          x-bind:class="$store.count == index + 1 ? 'bg-gray-600' : ''"
        ></button>
      </template> -->
        </div>
      </div>
    </div>
    <script>
      let blacklightCount = 3;
      let backgroundCount = 3;
      let bodyCount = 3;
      let headCount = 3;
      document.addEventListener("alpine:init", () => {
        Alpine.store("blacklight", 1);
        Alpine.store("background", 1);
        Alpine.store("body", 1);
        Alpine.store("head", 1);
        Alpine.store("headTraits", []);
        Alpine.store("bodyTraits", []);
        Alpine.store("backgroundTraits", []);
        Alpine.store("timer", "");
        Alpine.store("timeLeft", 1000);

        nfts = [
          { name: "Vamp #1234", image: "TestNFT.jpg" },
          { name: "Vamp #1398", image: "TestNFT.jpg" },
          { name: "Vamp #1278", image: "TestNFT.jpg" },
          { name: "Vamp #9999", image: "TestNFT.jpg" },
        ];
        Alpine.store("nfts", nfts);

        changeImage("blacklight");
        //Get traits
        const req = new XMLHttpRequest();
        req.addEventListener("load", reqListener);
        req.open("GET", "traits.json");
        req.send();
      });
      function changeImage(imageId) {
        index = Alpine.store(imageId);
        if (index > blacklightCount) index = 1;
        if (index < 1) index = blacklightCount;
        Alpine.store(imageId, index);
        console.log(`index set ${index}`);
        const element = document.querySelector(`.${imageId}`);
        let imageIndex;
        switch (imageId) {
          case "blacklight":
            imageIndex = 1;
            break;
          case "background":
            imageIndex = 2;
            break;
          case "body":
            imageIndex = 3;
            break;
          case "head":
            imageIndex = 4;
            break;
        }
        element.style.backgroundImage = `url(images/0${imageIndex}_0${index}.png)`;
      }
      function reqListener() {
        var headList = [];
        var bodyList = [];
        var backgroundList = [];
        const obj = JSON.parse(this.responseText);
        for (var i in obj.head) {
          headList.push(obj.head[i]);
        }
        for (var i in obj.body) {
          bodyList.push(obj.body[i]);
        }
        for (var i in obj.background) {
          backgroundList.push(obj.background[i]);
        }
        Alpine.store("headTraits", headList);
        Alpine.store("bodyTraits", bodyList);
        Alpine.store("backgroundTraits", backgroundList);
      }
    </script>
    <script src="timer.js"></script>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.10.8/html-to-image.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
  <script>
    function download() {
      // htmlToImage
      //   .toCanvas(document.getElementById("image"))
      //   .then(function (canvas) {
      //     document.body.appendChild(canvas);
      //   });

      htmlToImage
        .toBlob(document.getElementById("image"), {
          canvasWidth: 5000,
          canvasHeight: 5000,
          pixelRatio: 1,
        })
        .then(function (blob) {
          window.saveAs(blob, "blacklightNFT.png");
        });
    }
  </script>
</html>
